<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Hill ì•”í˜¸ ì‹œë®¬ë ˆì´ì…˜</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 800px;
            margin: 0 auto;
            background: white;
            border-radius: 20px;
            padding: 40px;
            box-shadow: 0 20px 60px rgba(0,0,0,0.3);
        }

        h1 {
            text-align: center;
            color: #333;
            margin-bottom: 30px;
            font-size: 2.5em;
        }

        .section {
            margin-bottom: 30px;
        }

        label {
            display: block;
            margin-bottom: 10px;
            color: #555;
            font-weight: bold;
            font-size: 1.1em;
        }

        select, input[type="text"] {
            width: 100%;
            padding: 12px;
            border: 2px solid #ddd;
            border-radius: 8px;
            font-size: 16px;
            transition: border-color 0.3s;
        }

        select:focus, input[type="text"]:focus {
            outline: none;
            border-color: #667eea;
        }

        .matrix-container {
            display: inline-block;
            margin: 20px 0;
        }

        .matrix-row {
            display: flex;
            gap: 10px;
            margin-bottom: 10px;
        }

        .matrix-input {
            width: 80px;
            padding: 10px;
            text-align: center;
            border: 2px solid #ddd;
            border-radius: 8px;
            font-size: 18px;
            font-weight: bold;
        }

        .matrix-input:focus {
            outline: none;
            border-color: #667eea;
        }

        .button-group {
            display: flex;
            gap: 10px;
            margin-top: 10px;
        }

        button {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            padding: 15px 40px;
            font-size: 18px;
            border-radius: 10px;
            cursor: pointer;
            transition: transform 0.2s, box-shadow 0.2s;
            font-weight: bold;
            flex: 1;
        }

        button:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 20px rgba(0,0,0,0.2);
        }

        button:active {
            transform: translateY(0);
        }

        .btn-validate {
            background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
        }

        .result {
            background: #f8f9fa;
            padding: 20px;
            border-radius: 10px;
            margin-top: 20px;
            border-left: 5px solid #667eea;
        }

        .result h3 {
            color: #333;
            margin-bottom: 10px;
        }

        .result p {
            font-size: 1.2em;
            color: #555;
            word-break: break-all;
            margin-bottom: 8px;
        }

        .error {
            background: #fee;
            border-left-color: #f44;
        }

        .success {
            background: #d4edda;
            border-left-color: #28a745;
        }

        .warning {
            background: #fff3cd;
            padding: 15px;
            border-radius: 8px;
            margin-top: 10px;
            color: #856404;
            font-size: 0.9em;
        }

        .bracket {
            font-size: 60px;
            display: flex;
            align-items: center;
            color: #667eea;
        }

        .matrix-display {
            display: flex;
            align-items: center;
            gap: 5px;
        }

        .validation-detail {
            background: white;
            padding: 15px;
            border-radius: 8px;
            margin-top: 10px;
        }

        .validation-detail ul {
            margin-left: 20px;
            margin-top: 10px;
        }

        .validation-detail li {
            margin: 5px 0;
            color: #555;
        }

        .check-mark {
            color: #28a745;
            font-size: 1.2em;
            margin-right: 5px;
        }

        .x-mark {
            color: #dc3545;
            font-size: 1.2em;
            margin-right: 5px;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>ğŸ” Hill ì•”í˜¸ ì‹œë®¬ë ˆì´ì…˜</h1>

        <div class="section">
            <label for="matrixSize">í–‰ë ¬ í¬ê¸° ì„ íƒ:</label>
            <select id="matrixSize" onchange="generateMatrixInputs()">
                <option value="2">2x2 í–‰ë ¬</option>
                <option value="3">3x3 í–‰ë ¬</option>
            </select>
        </div>

        <div class="section">
            <label>í‚¤ í–‰ë ¬ ì…ë ¥:</label>
            <div class="matrix-display">
                <span class="bracket">[</span>
                <div id="matrixInputs" class="matrix-container"></div>
                <span class="bracket">]</span>
            </div>
            <div class="button-group">
                <button class="btn-validate" onclick="validateMatrix()">âœ“ í–‰ë ¬ ìœ íš¨ì„± ê²€ì‚¬</button>
            </div>
            <div class="warning">
                âš ï¸ í–‰ë ¬ì‹ì´ 26ê³¼ ì„œë¡œì†Œì¸ í–‰ë ¬ì„ ì…ë ¥í•´ì•¼ ë³µí˜¸í™”ê°€ ê°€ëŠ¥í•©ë‹ˆë‹¤.
            </div>
        </div>

        <div id="validationResult"></div>

        <div class="section">
            <label for="plaintext">í‰ë¬¸ ì…ë ¥ (ëŒ€ë¬¸ì ì˜ì–´ë§Œ):</label>
            <input type="text" id="plaintext" placeholder="ì˜ˆ: HELLO" 
                   oninput="this.value = this.value.toUpperCase().replace(/[^A-Z]/g, '')">
        </div>

        <div class="section">
            <button onclick="encrypt()">ì•”í˜¸í™” ğŸ”’</button>
        </div>

        <div id="result"></div>
    </div>

    <script>
        // í˜ì´ì§€ ë¡œë“œ ì‹œ 2x2 í–‰ë ¬ ìƒì„±
        window.onload = function() {
            generateMatrixInputs();
        };

        // í–‰ë ¬ ì…ë ¥ í•„ë“œ ìƒì„±
        function generateMatrixInputs() {
            const size = parseInt(document.getElementById('matrixSize').value);
            const container = document.getElementById('matrixInputs');
            container.innerHTML = '';

            for (let i = 0; i < size; i++) {
                const row = document.createElement('div');
                row.className = 'matrix-row';
                
                for (let j = 0; j < size; j++) {
                    const input = document.createElement('input');
                    input.type = 'number';
                    input.className = 'matrix-input';
                    input.id = `m${i}${j}`;
                    input.placeholder = '0';
                    input.value = i === j ? '1' : '0'; // ê¸°ë³¸ê°’ìœ¼ë¡œ ë‹¨ìœ„í–‰ë ¬
                    row.appendChild(input);
                }
                
                container.appendChild(row);
            }
            
            // í–‰ë ¬ ë³€ê²½ ì‹œ ì´ì „ ê²€ì¦ ê²°ê³¼ ì´ˆê¸°í™”
            document.getElementById('validationResult').innerHTML = '';
        }

        // í‚¤ í–‰ë ¬ ê°€ì ¸ì˜¤ê¸°
        function getKeyMatrix() {
            const size = parseInt(document.getElementById('matrixSize').value);
            const matrix = [];

            for (let i = 0; i < size; i++) {
                matrix[i] = [];
                for (let j = 0; j < size; j++) {
                    const value = parseInt(document.getElementById(`m${i}${j}`).value) || 0;
                    matrix[i][j] = value;
                }
            }

            return matrix;
        }

        // í–‰ë ¬ì‹ ê³„ì‚°
        function determinant(matrix) {
            const size = matrix.length;
            
            if (size === 2) {
                return matrix[0][0] * matrix[1][1] - matrix[0][1] * matrix[1][0];
            } else if (size === 3) {
                return matrix[0][0] * (matrix[1][1] * matrix[2][2] - matrix[1][2] * matrix[2][1]) -
                       matrix[0][1] * (matrix[1][0] * matrix[2][2] - matrix[1][2] * matrix[2][0]) +
                       matrix[0][2] * (matrix[1][0] * matrix[2][1] - matrix[1][1] * matrix[2][0]);
            }
            return 0;
        }

        // ìµœëŒ€ê³µì•½ìˆ˜
        function gcd(a, b) {
            a = Math.abs(a);
            b = Math.abs(b);
            while (b !== 0) {
                let temp = b;
                b = a % b;
                a = temp;
            }
            return a;
        }

        // í‚¤ í–‰ë ¬ ìœ íš¨ì„± ê²€ì‚¬
        function validateMatrix() {
            const keyMatrix = getKeyMatrix();
            const size = keyMatrix.length;
            const validationDiv = document.getElementById('validationResult');
            
            // í–‰ë ¬ í‘œì‹œ
            let matrixDisplay = '<table style="margin: 10px 0;"><tr>';
            for (let i = 0; i < size; i++) {
                matrixDisplay += '<tr>';
                for (let j = 0; j < size; j++) {
                    matrixDisplay += `<td style="padding: 5px 10px; text-align: center; font-weight: bold;">${keyMatrix[i][j]}</td>`;
                }
                matrixDisplay += '</tr>';
            }
            matrixDisplay += '</table>';

            // í–‰ë ¬ì‹ ê³„ì‚°
            const det = determinant(keyMatrix);
            const detMod26 = ((det % 26) + 26) % 26;
            const isInvertible = gcd(detMod26, 26) === 1;

            // 26ê³¼ ì„œë¡œì†Œì¸ ìˆ«ìë“¤
            const coprimes = [1, 3, 5, 7, 9, 11, 15, 17, 19, 21, 23, 25];

            let resultHTML = '';

            if (isInvertible) {
                resultHTML = `
                    <div class="result success">
                        <h3><span class="check-mark">âœ“</span>ìœ íš¨í•œ í‚¤ í–‰ë ¬ì…ë‹ˆë‹¤!</h3>
                        <div class="validation-detail">
                            <p><strong>ì…ë ¥ëœ í–‰ë ¬:</strong></p>
                            ${matrixDisplay}
                            <p><strong>ê²€ì¦ ê²°ê³¼:</strong></p>
                            <ul>
                                <li><span class="check-mark">âœ“</span>í–‰ë ¬ì‹(det) = ${det}</li>
                                <li><span class="check-mark">âœ“</span>í–‰ë ¬ì‹ mod 26 = ${detMod26}</li>
                                <li><span class="check-mark">âœ“</span>gcd(${detMod26}, 26) = 1 (ì„œë¡œì†Œ)</li>
                                <li><span class="check-mark">âœ“</span>ì´ í–‰ë ¬ì€ Hill ì•”í˜¸ì˜ í‚¤ë¡œ ì‚¬ìš© ê°€ëŠ¥í•©ë‹ˆë‹¤.</li>
                            </ul>
                            <p style="margin-top: 15px; color: #28a745; font-weight: bold;">
                                â†’ ì•”í˜¸í™” ë° ë³µí˜¸í™”ê°€ ëª¨ë‘ ê°€ëŠ¥í•©ë‹ˆë‹¤! ğŸ‘
                            </p>
                        </div>
                    </div>
                `;
            } else {
                let reason = '';
                if (detMod26 === 0) {
                    reason = 'í–‰ë ¬ì‹ì´ 26ì˜ ë°°ìˆ˜ì´ë¯€ë¡œ ì—­í–‰ë ¬ì´ ì¡´ì¬í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤.';
                } else {
                    reason = `${detMod26}ëŠ” 26ê³¼ ì„œë¡œì†Œê°€ ì•„ë‹™ë‹ˆë‹¤. (gcd(${detMod26}, 26) = ${gcd(detMod26, 26)})`;
                }

                resultHTML = `
                    <div class="result error">
                        <h3><span class="x-mark">âœ—</span>ìœ íš¨í•˜ì§€ ì•Šì€ í‚¤ í–‰ë ¬ì…ë‹ˆë‹¤!</h3>
                        <div class="validation-detail">
                            <p><strong>ì…ë ¥ëœ í–‰ë ¬:</strong></p>
                            ${matrixDisplay}
                            <p><strong>ê²€ì¦ ê²°ê³¼:</strong></p>
                            <ul>
                                <li>í–‰ë ¬ì‹(det) = ${det}</li>
                                <li>í–‰ë ¬ì‹ mod 26 = ${detMod26}</li>
                                <li><span class="x-mark">âœ—</span>${reason}</li>
                            </ul>
                            <p style="margin-top: 15px; color: #dc3545; font-weight: bold;">
                                â†’ ì´ í–‰ë ¬ë¡œëŠ” ë³µí˜¸í™”ê°€ ë¶ˆê°€ëŠ¥í•©ë‹ˆë‹¤! âš ï¸
                            </p>
                            <p style="margin-top: 10px; color: #856404;">
                                <strong>ğŸ’¡ íŒíŠ¸:</strong> í–‰ë ¬ì‹ì„ 26ìœ¼ë¡œ ë‚˜ëˆˆ ë‚˜ë¨¸ì§€ê°€ ë‹¤ìŒ ì¤‘ í•˜ë‚˜ê°€ ë˜ë„ë¡ í–‰ë ¬ì„ ìˆ˜ì •í•˜ì„¸ìš”:<br>
                                ${coprimes.join(', ')}
                            </p>
                        </div>
                    </div>
                `;
            }

            validationDiv.innerHTML = resultHTML;
        }

        // ë¬¸ìë¥¼ ìˆ«ìë¡œ ë³€í™˜ (A=0, B=1, ..., Z=25)
        function charToNum(char) {
            return char.charCodeAt(0) - 65;
        }

        // ìˆ«ìë¥¼ ë¬¸ìë¡œ ë³€í™˜
        function numToChar(num) {
            return String.fromCharCode((num % 26 + 26) % 26 + 65);
        }

        // í–‰ë ¬ ê³±ì…ˆ
        function multiplyMatrixVector(matrix, vector) {
            const result = [];
            for (let i = 0; i < matrix.length; i++) {
                let sum = 0;
                for (let j = 0; j < vector.length; j++) {
                    sum += matrix[i][j] * vector[j];
                }
                result.push(sum % 26);
            }
            return result;
        }

        // Hill ì•”í˜¸í™”
        function encrypt() {
            const plaintext = document.getElementById('plaintext').value;
            const keyMatrix = getKeyMatrix();
            const size = keyMatrix.length;
            const resultDiv = document.getElementById('result');

            // ì…ë ¥ ê²€ì¦
            if (!plaintext) {
                resultDiv.innerHTML = '<div class="result error"><h3>âŒ ì˜¤ë¥˜</h3><p>í‰ë¬¸ì„ ì…ë ¥í•´ì£¼ì„¸ìš”.</p></div>';
                return;
            }

            // í–‰ë ¬ì‹ ê²€ì¦
            const det = determinant(keyMatrix);
            const detMod26 = ((det % 26) + 26) % 26;
            
            if (gcd(detMod26, 26) !== 1) {
                resultDiv.innerHTML = `<div class="result error">
                    <h3>âŒ ì˜¤ë¥˜</h3>
                    <p>í‚¤ í–‰ë ¬ì˜ í–‰ë ¬ì‹(${det})ì´ 26ê³¼ ì„œë¡œì†Œê°€ ì•„ë‹™ë‹ˆë‹¤.</p>
                    <p>í–‰ë ¬ì‹ì„ 26ìœ¼ë¡œ ë‚˜ëˆˆ ë‚˜ë¨¸ì§€(${detMod26})ê°€ 1, 3, 5, 7, 9, 11, 15, 17, 19, 21, 23, 25 ì¤‘ í•˜ë‚˜ì—¬ì•¼ í•©ë‹ˆë‹¤.</p>
                    <p style="margin-top: 10px;">ğŸ’¡ <strong>í–‰ë ¬ ìœ íš¨ì„± ê²€ì‚¬</strong> ë²„íŠ¼ì„ ëˆŒëŸ¬ ìì„¸í•œ ì •ë³´ë¥¼ í™•ì¸í•˜ì„¸ìš”.</p>
                </div>`;
                return;
            }

            // í‰ë¬¸ ê¸¸ì´ë¥¼ í–‰ë ¬ í¬ê¸°ì˜ ë°°ìˆ˜ë¡œ ë§ì¶”ê¸°
            let paddedText = plaintext;
            while (paddedText.length % size !== 0) {
                paddedText += 'X';
            }

            let ciphertext = '';
            let process = '<div class="result"><h3>ğŸ“Š ì•”í˜¸í™” ê³¼ì •</h3>';

            // ë¸”ë¡ ë‹¨ìœ„ë¡œ ì•”í˜¸í™”
            for (let i = 0; i < paddedText.length; i += size) {
                const block = paddedText.substr(i, size);
                const vector = [];
                
                for (let j = 0; j < size; j++) {
                    vector.push(charToNum(block[j]));
                }

                const encrypted = multiplyMatrixVector(keyMatrix, vector);
                
                let blockCipher = '';
                for (let j = 0; j < size; j++) {
                    blockCipher += numToChar(encrypted[j]);
                }
                
                ciphertext += blockCipher;

                // ê³¼ì • í‘œì‹œ
                process += `<p><strong>${block}</strong> â†’ [${vector.join(', ')}] â†’ [${encrypted.join(', ')}] â†’ <strong>${blockCipher}</strong></p>`;
            }

            process += '</div>';

            resultDiv.innerHTML = `
                <div class="result success">
                    <h3>ğŸ”’ ì•”í˜¸ë¬¸</h3>
                    <p style="font-size: 1.5em; font-weight: bold; color: #667eea;">${ciphertext}</p>
                </div>
                ${process}
                <div class="result">
                    <h3>â„¹ï¸ ì •ë³´</h3>
                    <p>ì›ë³¸ í‰ë¬¸: ${plaintext}</p>
                    <p>íŒ¨ë”©ëœ í‰ë¬¸: ${paddedText}</p>
                    <p>í–‰ë ¬ í¬ê¸°: ${size}x${size}</p>
                    <p>í–‰ë ¬ì‹ (mod 26): ${detMod26}</p>
                </div>
            `;
        }
    </script>
</body>
</html>
